@echo off
chcp 65001 >nul
setlocal enabledelayedexpansion

title ðŸ¤– REZONIC SWARM v2.0 - SOVEREIGN AI ENGINE
color 0C

:: ============================================================================
:: REZONIC SWARM - SOVEREIGN AI BACKEND
:: With Constitutional AI, Smart Router, and JARVIS Auto-Healer Integration
:: ============================================================================

:init
cls
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                    ðŸ¤– REZONIC SWARM v2.0                                 â•‘
echo â•‘                    SOVEREIGN AI ENGINE                                   â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo [SYSTEM] Constitutional AI â€¢ ACTIVE
echo [SYSTEM] Zero-Drift Engine â€¢ ENABLED
echo [SYSTEM] Smart Router â€¢ 24 Models
echo [SYSTEM] JARVIS Auto-Healer â€¢ INTEGRATED
echo.

:: ============================================================================
:: CONFIGURATION - EDIT THESE PATHS
:: ============================================================================
set REZSTACK_ROOT=G:\okiru\app builder\RezStackFinal2\RezStackFinal
set SWARM_ROOT=%REZSTACK_ROOT%\src\rezonic-swarm
set BRIDGE_ROOT=%REZSTACK_ROOT%\src\constitutional-bridge
set JARVIS_ROOT=%REZSTACK_ROOT%\src\sovereign-jarvis
set AUTO_HEALER=%JARVIS_ROOT%\jarvis-auto-heal.py

:: ============================================================================
:: MAIN MENU
:: ============================================================================
:menu
echo.
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                         REZONIC SWARM CONTROL PANEL                       â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo  [1] ðŸš€ START SWARM     - Launch Rezonic Swarm (port 8000)
echo  [2] âš–ï¸  START BRIDGE   - Launch Constitutional Bridge (port 8001)
echo  [3] ðŸ”— START ALL       - Launch Swarm + Bridge + JARVIS
echo  [4] ðŸ” SWARM HEALTH    - Check Swarm API status
echo  [5] ðŸ“Š MODEL STATUS   - List available Ollama models
echo  [6] ðŸ› ï¸  AUTO-HEAL     - Scan + Fix Swarm codebase
echo  [7] ðŸ’¾ AUTO-COMMIT    - Scan + Fix + Commit Swarm fixes
echo  [8] ðŸ“¤ AUTO-PUSH      - Scan + Fix + Commit + Push to GitHub
echo  [9] ðŸ“‹ VIEW LOGS      - Show recent Swarm logs
echo  [10] ðŸ”„ RESTART ALL   - Restart all services
echo  [11] ðŸ§¹ CLEAN CACHE   - Clear Vite/Python cache
echo  [0] EXIT
echo.
set /p choice="ðŸ¤– Swarm ready. Select command: "

if "%choice%"=="1" goto start_swarm
if "%choice%"=="2" goto start_bridge
if "%choice%"=="3" goto start_all
if "%choice%"=="4" goto swarm_health
if "%choice%"=="5" goto model_status
if "%choice%"=="6" goto auto_heal_swarm
if "%choice%"=="7" goto auto_commit_swarm
if "%choice%"=="8" goto auto_push_swarm
if "%choice%"=="9" goto view_logs
if "%choice%"=="10" goto restart_all
if "%choice%"=="11" goto clean_cache
if "%choice%"=="0" goto exit
goto menu

:: ============================================================================
:: START REZONIC SWARM (PORT 8000)
:: ============================================================================
:start_swarm
cls
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                        ðŸš€ STARTING REZONIC SWARM                         â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo [1/2] Checking Ollama connection...
curl -s http://localhost:11434/api/tags >nul 2>&1
if %errorlevel% neq 0 (
    echo   âš ï¸  Ollama not running! Starting Ollama...
    start "" "C:\Users\Zphoenix\AppData\Local\Programs\Ollama\Ollama.exe"
    timeout /t 5 /nobreak >nul
) else (
    echo   âœ… Ollama connected
)

echo [2/2] Launching Swarm on port 8000...
echo.
cd /d "%SWARM_ROOT%"
start "ðŸ¤– Rezonic Swarm (8000)" /MIN cmd /k "python simple-swarm.py"
timeout /t 3 /nobreak >nul

:: Verify Swarm is running
curl -s http://localhost:8000/health >nul 2>&1
if %errorlevel% equ 0 (
    echo   âœ… Swarm is RUNNING on http://localhost:8000
    echo   ðŸ“š API Docs: http://localhost:8000/docs
) else (
    echo   âŒ Swarm failed to start
)
pause
goto menu

:: ============================================================================
:: START CONSTITUTIONAL BRIDGE (PORT 8001)
:: ============================================================================
:start_bridge
cls
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                     âš–ï¸  STARTING CONSTITUTIONAL BRIDGE                  â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
cd /d "%BRIDGE_ROOT%"
start "âš–ï¸ Constitutional Bridge (8001)" /MIN cmd /k "python main.py"
timeout /t 3 /nobreak >nul

:: Verify Bridge is running
curl -s http://localhost:8001/health >nul 2>&1
if %errorlevel% equ 0 (
    echo   âœ… Constitutional Bridge is RUNNING on http://localhost:8001
) else (
    echo   âŒ Bridge failed to start
)
pause
goto menu

:: ============================================================================
:: START ALL SERVICES (Swarm + Bridge + JARVIS)
:: ============================================================================
:start_all
cls
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                    ðŸ”— STARTING COMPLETE ECOSYSTEM                        â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

:: Start Ollama if not running
echo [1/4] Checking Ollama...
curl -s http://localhost:11434/api/tags >nul 2>&1
if %errorlevel% neq 0 (
    echo   ðŸš€ Starting Ollama...
    start "" "C:\Users\Zphoenix\AppData\Local\Programs\Ollama\Ollama.exe"
    timeout /t 5 /nobreak >nul
) else (
    echo   âœ… Ollama already running
)

:: Start Swarm
echo [2/4] Launching Rezonic Swarm (8000)...
cd /d "%SWARM_ROOT%"
start "ðŸ¤– Rezonic Swarm" /MIN cmd /k "python simple-swarm.py"
timeout /t 3 /nobreak >nul

:: Start Bridge
echo [3/4] Launching Constitutional Bridge (8001)...
cd /d "%BRIDGE_ROOT%"
start "âš–ï¸ Constitutional Bridge" /MIN cmd /k "python main.py"
timeout /t 3 /nobreak >nul

:: Start JARVIS API
echo [4/4] Launching JARVIS API (8002)...
cd /d "%JARVIS_ROOT%"
start "ðŸŽ­ JARVIS API" /MIN cmd /k "python main.py"
timeout /t 3 /nobreak >nul

echo.
echo âœ… ALL SERVICES STARTED
echo.
echo   ðŸ¤– Swarm:  http://localhost:8000  | Docs: http://localhost:8000/docs
echo   âš–ï¸ Bridge: http://localhost:8001
echo   ðŸŽ­ JARVIS: http://localhost:8002  | UI: http://localhost:8002/ui
echo.
pause
goto menu

:: ============================================================================
:: CHECK SWARM HEALTH
:: ============================================================================
:swarm_health
cls
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                        ðŸ” SWARM HEALTH CHECK                            â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
curl -s http://localhost:8000/health
if %errorlevel% neq 0 (
    echo.
    echo âŒ Swarm is NOT responding
) else (
    echo.
    echo âœ… Swarm is healthy
)
echo.
pause
goto menu

:: ============================================================================
:: CHECK OLLAMA MODEL STATUS
:: ============================================================================
:model_status
cls
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                        ðŸ“Š OLLAMA MODEL STATUS                           â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo Fetching available models...
echo.
ollama list
echo.
pause
goto menu

:: ============================================================================
:: AUTO-HEAL SWARM CODEBASE (Scan + Fix + Report)
:: ============================================================================
:auto_heal_swarm
cls
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                    ðŸ› ï¸  AUTO-HEALING SWARM CODEBASE                      â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo âš•ï¸  JARVIS Auto-Healer engaged...
echo.
if exist "%AUTO_HEALER%" (
    python "%AUTO_HEALER%" "%SWARM_ROOT%" --no-commit --no-push
) else (
    echo âŒ JARVIS Auto-Healer not found at: %AUTO_HEALER%
)
pause
goto menu

:: ============================================================================
:: AUTO-COMMIT SWARM FIXES (Scan + Fix + Commit)
:: ============================================================================
:auto_commit_swarm
cls
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                    ðŸ’¾ AUTO-COMMITTING SWARM FIXES                       â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
if exist "%AUTO_HEALER%" (
    python "%AUTO_HEALER%" "%SWARM_ROOT%" --no-push
) else (
    echo âŒ JARVIS Auto-Healer not found
)
pause
goto menu

:: ============================================================================
:: AUTO-PUSH SWARM FIXES (Scan + Fix + Commit + Push)
:: ============================================================================
:auto_push_swarm
cls
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                    ðŸ“¤ AUTO-PUSHING SWARM FIXES                          â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
if exist "%AUTO_HEALER%" (
    python "%AUTO_HEALER%" "%SWARM_ROOT%"
) else (
    echo âŒ JARVIS Auto-Healer not found
)
pause
goto menu

:: ============================================================================
:: VIEW SWARM LOGS
:: ============================================================================
:view_logs
cls
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                        ðŸ“‹ RECENT SWARM LOGS                             â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
set LOG_DIR=%REZSTACK_ROOT%\logs
if exist "%LOG_DIR%" (
    dir /b /o-d "%LOG_DIR%\swarm-*.log" 2>nul
    echo.
    set /p logfile="ðŸ“„ Enter log filename (or 0 to cancel): "
    if not "!logfile!"=="0" (
        if exist "%LOG_DIR%\!logfile!" (
            type "%LOG_DIR%\!logfile!" | more
        ) else (
            echo âŒ Log file not found
        )
    )
) else (
    echo ðŸ“­ No logs found
)
pause
goto menu

:: ============================================================================
:: RESTART ALL SERVICES
:: ============================================================================
:restart_all
cls
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                        ðŸ”„ RESTARTING ALL SERVICES                       â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo Stopping all Python processes...
taskkill /f /im python.exe >nul 2>&1
timeout /t 3 /nobreak >nul
echo âœ… All services stopped
echo.
goto start_all

:: ============================================================================
:: CLEAN CACHE
:: ============================================================================
:clean_cache
cls
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                        ðŸ§¹ CLEANING CACHE FILES                          â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo [1/2] Cleaning Python cache...
cd /d "%SWARM_ROOT%"
rmdir /s /q __pycache__ 2>nul
echo   âœ… Python cache cleared

echo [2/2] Cleaning Vite cache...
cd /d "%REZSTACK_ROOT%"
rmdir /s /q node_modules\.vite 2>nul
echo   âœ… Vite cache cleared

echo.
echo âœ… Cache cleanup complete
pause
goto menu

:: ============================================================================
:: EXIT
:: ============================================================================
:exit
cls
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘                 ðŸ¤– Rezonic Swarm disengaged.                            â•‘
echo â•‘                    Zero-Drift Engine â€¢ STANDBY                          â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
timeout /t 2 /nobreak >nul
exit /b